<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Adam Novotny">
    <meta name="description" content="Contents Summary Notebook Summary In general, a machine learning pipeline should have the following characteristics: To ensure data consistency,...">
    <title>Scikit-learn Pipeline with Feature Engineering | ANotes</title>
    <link rel="icon" type="image/png" sizes="32x32" href="https://adamnovotny.com/theme/images/favicon.png">
<link rel="canonical" href="https://adamnovotny.com/blog/custom-scikit-learn-pipeline.html">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <link rel="stylesheet" href="https://adamnovotny.com/theme/css/blog.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="https://adamnovotny.com">
          <img src="https://adamnovotny.com/theme/images/adamnovotny_logo.png" alt="">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Articles
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="https://adamnovotny.com/category/aviation.html">Aviation <i class="fas fa-plane fa-md"></i></a></li>
                <li><a class="dropdown-item" href="https://adamnovotny.com/category/machine-learning.html">Machine Learning <i class="fas fa-laptop fa-md"></i></a></li>
                <li><a class="dropdown-item" href="https://adamnovotny.com">All articles</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                About
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="https://adamnovotny.com/pages/bookshelf.html">Bookshelf <i class="fas fa-book fa-sm"></i></a></li>
                <li><a class="dropdown-item" href="https://adamnovotny.com/feeds/atom.xml">Feed Atom</a></li>
                <li><a class="dropdown-item" href="https://adamnovotny.com/feeds/rss.xml">Feed RSS <i class="fas fa-rss-square fa-sm"></i></a></li>
                <li><a class="dropdown-item" href="https://github.com/adamnovotnycom">Github <i class="fab fa-github fa-md"></i></a></li>
                <li><a class="dropdown-item" href="https://www.linkedin.com/in/adamnovotnycom">LinkedIn <i class="fab fa-linkedin fa-md"></i></a></li>
              </ul>
            </li>
          </ul>
          <a class="dropdown-item" href="https://privatewho.is/?s=adamnovotny.com">Email Me</a>
        </div>
      </div>
    </nav>
      

<main class="container">
    <div class="row">
        <div class="col"></div>
        <div class="col-md-10">
    
            <div class="blog-post">
            <h2 class="blog-post-title">Scikit-learn Pipeline with Feature Engineering</h2>
            <p class="blog-post-meta" >
                Published: 2021-08-30
                . <a href="https://medium.com/@adamnovotnycom/custom-scikit-learn-pipeline-925dcd25ca89/" target="_blank"><i class="fab fa-medium fa-lg"></i></a>
                . Updated: 2021-10-17
            </p>
            <h4>Contents</h4>
<ol>
<li><a href="#summary">Summary</a></li>
<li><a href="#notebook">Notebook</a></li>
</ol>
<h4 id="summary">Summary</h4>
<p>In general, a machine learning pipeline should have the following characteristics:</p>
<p><a href="/theme/images/1*8PUAA9DjMv6CMsPWhbayIQ.png.png"><img src="/theme/images/1*8PUAA9DjMv6CMsPWhbayIQ.png.png" alt="scikit-learn logo" style="width: 50%" loading="lazy"></a></p>
<ul>
    <li>To ensure data consistency, the pipeline should include every step (such as feature engineering) required to train and score training and testing datasets, and score real time requests. The pipeline does not need to include one-off steps such as removing duplicates.</li>
    <li>Numerical features are transformed using scikit-learn classes. SimpleImputer is used to fill missing values and StandardScaler for scaling.</li>
    <li>Categorical columns are similarly transformed. OneHotEncoder is applied transforming columns containing categorical values. Importantly, I like to define the categories argument to prevent the <a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality" target="_blank">Curse of dimensionality</a> that might occur when too many categories are present.</li>
    <li>An example custom feature engineering class DailyTrendFeature is included in the pipeline for illustration.</li>
    <li>The pipeline allows for parallel preprocessing subject to the limits of the computing environment. For example, the preprocessing of categorical and numerical features can take place in parallel because the transformation steps are independent of each other. This is accomplished using scikit-learn's <pre>FeatureUnion(n_jobs=-1, ...)</pre> class that combines other pipeline steps.</li>
    <li><a href="https://gist.github.com/adamnovotnycom/a09294f179d8e483d5411eb5c8c4e00f" target="_blank">Notebook as Github Gist</a></li>
</ul>

<h4 id="notebook">Notebook</h4>
<p><iframe
  title="Scikit-learn Pipeline with Feature Engineering notebook"
  width="100%"
  height="10000px"
  src="/notebooks/sklearn_pipe.html">
</iframe>
</p>
            </div>
    
        </div>
        <div class="col"></div>
    </div>
</main>

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    <!-- dev Vue -->
    <!-- <script src="https://unpkg.com/vue@3.2"></script>  -->
    <!-- prod Vue -->
    <script src="https://unpkg.com/vue@3.2/dist/vue.global.prod.js"></script>
    
</body>


</html>